<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>Enrolment on endpointmgt.com</title>
        <link>http://localhost:1313/categories/enrolment/</link>
        <description>Recent content in Enrolment on endpointmgt.com</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>en-us</language>
        <lastBuildDate>Mon, 22 Jan 2024 10:59:19 +0100</lastBuildDate><atom:link href="http://localhost:1313/categories/enrolment/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>Missing Microsoft Enrolment App</title>
        <link>http://localhost:1313/p/recreateenrolmentapp/</link>
        <pubDate>Mon, 22 Jan 2024 10:59:19 +0100</pubDate>
        
        <guid>http://localhost:1313/p/recreateenrolmentapp/</guid>
        <description>&lt;img src="http://localhost:1313/p/recreateenrolmentapp/post/MissingEnrolmentApp/img/cover.png" alt="Featured image of post Missing Microsoft Enrolment App" /&gt;&lt;p&gt;Missing this app in your M365 tenant and need it for Conditional Access? This was a recent issue that I came across while working on a tenant to tenant migration project. The Issue? Re-enrolling fully managed (COPE) devices and the requirement to exclude the enrollment from MFA prompts. The only problem, only the Microsoft Intune app existed.&lt;/p&gt;
&lt;p&gt;As you can see below, the Microsoft Intune app is missing from the Mobility MDM and WIP page.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://localhost:1313/p/recreateenrolmentapp/post/MissingEnrolmentApp/img/image-1.png&#34;
	width=&#34;474&#34;
	height=&#34;223&#34;
	srcset=&#34;http://localhost:1313/p/recreateenrolmentapp/post/MissingEnrolmentApp/img/image-1_hu_869cafa68da317a3.png 480w, http://localhost:1313/p/recreateenrolmentapp/post/MissingEnrolmentApp/img/image-1_hu_612badd42150d4b8.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;Missing Enrolment App&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;212&#34;
		data-flex-basis=&#34;510px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;As you can also see, it’s missing from the Target Resources within the Conditional Access Policies.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://localhost:1313/p/recreateenrolmentapp/post/MissingEnrolmentApp/img/image-2.png&#34;
	width=&#34;889&#34;
	height=&#34;569&#34;
	srcset=&#34;http://localhost:1313/p/recreateenrolmentapp/post/MissingEnrolmentApp/img/image-2_hu_5ffe9ca43b702b6c.png 480w, http://localhost:1313/p/recreateenrolmentapp/post/MissingEnrolmentApp/img/image-2_hu_aee2aa3ac4b62fe9.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;Conditional Access Selection&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;156&#34;
		data-flex-basis=&#34;374px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;To resolve the issue, we need a way of recreating the app that Microsoft will recognise as the Intune enrolment app, we can’t simply create an Enterprise Application called the same name. We’ll do this by creating a new Service Principle.&lt;/p&gt;
&lt;p&gt;First, we’re going to login to Entra ID using Powershell.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Connect-AzureAD&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://localhost:1313/p/recreateenrolmentapp/post/MissingEnrolmentApp/img/image-3.png&#34;
	width=&#34;951&#34;
	height=&#34;211&#34;
	srcset=&#34;http://localhost:1313/p/recreateenrolmentapp/post/MissingEnrolmentApp/img/image-3_hu_acbe48cc74e1b086.png 480w, http://localhost:1313/p/recreateenrolmentapp/post/MissingEnrolmentApp/img/image-3_hu_e87d245b4b6bb559.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;Connect to Entra&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;450&#34;
		data-flex-basis=&#34;1081px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;Lets now check if the app exists, run the get command to see if it exists.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Get-AzureADServicePrincipal -AppId d4ebce55-015a-49b5-a083-c84d1797ae8c&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;If it returned nothing back and simply returned back to a new command line, then we need to create the app. We’ll first clear any record of it from the tenant by removing the SP.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Remove-AzureADServicePrincipal -AppId d4ebce55-015a-49b5-a083-c84d1797ae8c&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Once complete, we’re now going to recreate it. Don’t make any changes to the command.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;New-AzureADServicePrincipal -AppId d4ebce55-015a-49b5-a083-c84d1797ae8c&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;To confirm it’s created, PS will show you the new Service Principle with the correct display name of the require Intune enrollment app.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://localhost:1313/p/recreateenrolmentapp/post/MissingEnrolmentApp/img/image-4.png&#34;
	width=&#34;975&#34;
	height=&#34;205&#34;
	srcset=&#34;http://localhost:1313/p/recreateenrolmentapp/post/MissingEnrolmentApp/img/image-4_hu_ba846775bc50c6a4.png 480w, http://localhost:1313/p/recreateenrolmentapp/post/MissingEnrolmentApp/img/image-4_hu_ef115481583cc253.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;Create Entra Service Principal&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;475&#34;
		data-flex-basis=&#34;1141px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;We can now also see the app listed in the Mobility page&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://localhost:1313/p/recreateenrolmentapp/post/MissingEnrolmentApp/img/image-5.png&#34;
	width=&#34;458&#34;
	height=&#34;267&#34;
	srcset=&#34;http://localhost:1313/p/recreateenrolmentapp/post/MissingEnrolmentApp/img/image-5_hu_856a55f12f637a6d.png 480w, http://localhost:1313/p/recreateenrolmentapp/post/MissingEnrolmentApp/img/image-5_hu_8ac63a3820a18508.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;Mobility Page&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;171&#34;
		data-flex-basis=&#34;411px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;And, if you now select the app from the CA policy, it should be listed. You’ll need to refresh the page if you still have it open from checking previously.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;http://localhost:1313/p/recreateenrolmentapp/post/MissingEnrolmentApp/img/image-6.png&#34;
	width=&#34;900&#34;
	height=&#34;568&#34;
	srcset=&#34;http://localhost:1313/p/recreateenrolmentapp/post/MissingEnrolmentApp/img/image-6_hu_6059c9c680b98f4d.png 480w, http://localhost:1313/p/recreateenrolmentapp/post/MissingEnrolmentApp/img/image-6_hu_cff216257318c3cd.png 1024w&#34;
	loading=&#34;lazy&#34;
	
		alt=&#34;Updated Conditional Access Selection&#34;
	
	
		class=&#34;gallery-image&#34; 
		data-flex-grow=&#34;158&#34;
		data-flex-basis=&#34;380px&#34;
	
&gt;&lt;/p&gt;
&lt;p&gt;And your done. Now all you have to do is save your CA policy and test the results.&lt;/p&gt;
</description>
        </item>
        
    </channel>
</rss>
