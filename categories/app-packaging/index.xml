<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>App Packaging on endpointmgt.com</title><link>https://endpointmgt.com/categories/app-packaging/</link><description>Recent content in App Packaging on endpointmgt.com</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Wed, 29 Jan 2025 19:45:32 +0100</lastBuildDate><atom:link href="https://endpointmgt.com/categories/app-packaging/index.xml" rel="self" type="application/rss+xml"/><item><title>Deploy SOLUS 3 for SIMS</title><link>https://endpointmgt.com/p/deploysims/</link><pubDate>Wed, 29 Jan 2025 19:45:32 +0100</pubDate><guid>https://endpointmgt.com/p/deploysims/</guid><description>&lt;img src="https://endpointmgt.com/p/deploysims/post/InstallSims/img/cover.png" alt="Featured image of post Deploy SOLUS 3 for SIMS" />&lt;p>On a recent engagement in my day job, I had a challenge to deploy Solus3 agent to Microsoft Entra joined devices. These devices were enrolled via Windows Autopilot and no longer domain joined. The existing deployment deployed the Solus3 agent via a targeted AD OU, which deploys the agent via the deployment server. This of course, isn’t possible with Entra joined devices.&lt;/p>
&lt;p>To get this to work, its a wrap within a wrap. Keeping it as close the production or what your using or how you might already deploy the app as close the the existing deployment but with a few tweaks. Anyways for now, here are the steps to deploy the agent via Microsoft Intune. After all, it’s why you’re here 🙂&lt;/p>
&lt;blockquote>
&lt;p>It should be noted that this approach to deployment is NOT supported. Do so at your own risk. You may still need to keep an instance of a supported deployment. This will allow you to replicate the any issue on a supported deployment for escalation.&lt;/p>&lt;/blockquote>
&lt;h2 id="preparation">Preparation
&lt;/h2>&lt;p>You’ll need to gather the relevant files and create a folder for the install files, called SIMS. In my example, I’ve placed the SIMS folder on the root of the D:\ drive. Copy the following files over to the SIMS folder.&lt;/p>
&lt;ul>
&lt;li>SOLUS3AgentInstaller_x86.msi&lt;/li>
&lt;li>SOLUS3AgentInstaller_x64.msi&lt;/li>
&lt;li>Solus3.Keys.DeploymentService.Public.xml&lt;/li>
&lt;/ul>
&lt;h3 id="first-installer-file">First installer File
&lt;/h3>&lt;p>Create a .bat file named Solus3AgentInstaller.bat with the following commands.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-Powershell" data-lang="Powershell">&lt;span class="line">&lt;span class="cl">&lt;span class="n">cscript&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="py">exe&lt;/span> &lt;span class="p">//&lt;/span>&lt;span class="n">nologo&lt;/span> &lt;span class="n">AgentInstaller&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="py">js&lt;/span> &lt;span class="s2">&amp;#34;agent_installer.log&amp;#34;&lt;/span> &lt;span class="s2">&amp;#34;net.tcp://localhost:52966&amp;#34;&lt;/span> &lt;span class="s2">&amp;#34;net.tcp://Your-SIMS-Server:52965&amp;#34;&lt;/span> &lt;span class="s2">&amp;#34;Solus3.Keys.DeploymentService.Public.xml&amp;#34;&lt;/span> &lt;span class="s2">&amp;#34;SOLUS3AgentInstaller_x86.msi&amp;#34;&lt;/span> &lt;span class="s2">&amp;#34;SOLUS3AgentInstaller_x64.msi&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Update the &lt;code>net.tcp://Your-SIMS-Server:52965&lt;/code> with your server location and save the .bat file in your newly created SIMS folder.&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt"> 1
&lt;/span>&lt;span class="lnt"> 2
&lt;/span>&lt;span class="lnt"> 3
&lt;/span>&lt;span class="lnt"> 4
&lt;/span>&lt;span class="lnt"> 5
&lt;/span>&lt;span class="lnt"> 6
&lt;/span>&lt;span class="lnt"> 7
&lt;/span>&lt;span class="lnt"> 8
&lt;/span>&lt;span class="lnt"> 9
&lt;/span>&lt;span class="lnt">10
&lt;/span>&lt;span class="lnt">11
&lt;/span>&lt;span class="lnt">12
&lt;/span>&lt;span class="lnt">13
&lt;/span>&lt;span class="lnt">14
&lt;/span>&lt;span class="lnt">15
&lt;/span>&lt;span class="lnt">16
&lt;/span>&lt;span class="lnt">17
&lt;/span>&lt;span class="lnt">18
&lt;/span>&lt;span class="lnt">19
&lt;/span>&lt;span class="lnt">20
&lt;/span>&lt;span class="lnt">21
&lt;/span>&lt;span class="lnt">22
&lt;/span>&lt;span class="lnt">23
&lt;/span>&lt;span class="lnt">24
&lt;/span>&lt;span class="lnt">25
&lt;/span>&lt;span class="lnt">26
&lt;/span>&lt;span class="lnt">27
&lt;/span>&lt;span class="lnt">28
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-json" data-lang="json">&lt;span class="line">&lt;span class="cl">&lt;span class="err">var&lt;/span> &lt;span class="err">wshShell,&lt;/span> &lt;span class="err">wshSysEnv;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">var&lt;/span> &lt;span class="err">fso,&lt;/span> &lt;span class="err">f&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="err">,&lt;/span> &lt;span class="err">typeLib;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">fso&lt;/span> &lt;span class="err">=&lt;/span> &lt;span class="err">new&lt;/span> &lt;span class="err">ActiveXObject(&lt;/span>&lt;span class="s2">&amp;#34;Scripting.FileSystemObject&amp;#34;&lt;/span>&lt;span class="err">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">typeLib&lt;/span> &lt;span class="err">=&lt;/span> &lt;span class="err">new&lt;/span> &lt;span class="err">ActiveXObject(&lt;/span>&lt;span class="s2">&amp;#34;Scriptlet.TypeLib&amp;#34;&lt;/span>&lt;span class="err">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">wshShell&lt;/span> &lt;span class="err">=&lt;/span> &lt;span class="err">WScript.CreateObject(&lt;/span>&lt;span class="s2">&amp;#34;WScript.Shell&amp;#34;&lt;/span>&lt;span class="err">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">var&lt;/span> &lt;span class="err">logFileName&lt;/span> &lt;span class="err">=&lt;/span> &lt;span class="err">WScript.Arguments(&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="err">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">var&lt;/span> &lt;span class="err">agentAddress&lt;/span> &lt;span class="err">=&lt;/span> &lt;span class="err">WScript.Arguments(&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="err">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">var&lt;/span> &lt;span class="err">dsAddress&lt;/span> &lt;span class="err">=&lt;/span> &lt;span class="err">WScript.Arguments(&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="err">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">var&lt;/span> &lt;span class="err">keyFileName&lt;/span> &lt;span class="err">=&lt;/span> &lt;span class="err">WScript.Arguments(&lt;/span>&lt;span class="mi">3&lt;/span>&lt;span class="err">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">var&lt;/span> &lt;span class="err">msi&lt;/span>&lt;span class="mi">32&lt;/span> &lt;span class="err">=&lt;/span> &lt;span class="err">WScript.Arguments(&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="err">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">var&lt;/span> &lt;span class="err">msi&lt;/span>&lt;span class="mi">64&lt;/span> &lt;span class="err">=&lt;/span> &lt;span class="err">WScript.Arguments(&lt;/span>&lt;span class="mi">5&lt;/span>&lt;span class="err">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">var&lt;/span> &lt;span class="err">msi&lt;/span> &lt;span class="err">=&lt;/span> &lt;span class="s2">&amp;#34;&amp;#34;&lt;/span>&lt;span class="err">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">if&lt;/span> &lt;span class="err">(is&lt;/span>&lt;span class="mi">64&lt;/span>&lt;span class="err">())&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">msi&lt;/span> &lt;span class="err">=&lt;/span> &lt;span class="err">msi&lt;/span>&lt;span class="mi">64&lt;/span>&lt;span class="err">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">else&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">msi&lt;/span> &lt;span class="err">=&lt;/span> &lt;span class="err">msi&lt;/span>&lt;span class="mi">32&lt;/span>&lt;span class="err">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">wshShell.Run(&lt;/span>&lt;span class="s2">&amp;#34;msiexec.exe /qb /lv* \&amp;#34;&amp;#34;&lt;/span> &lt;span class="err">+&lt;/span> &lt;span class="err">fso.BuildPath(wshShell.Environment(&lt;/span>&lt;span class="s2">&amp;#34;SYSTEM&amp;#34;&lt;/span>&lt;span class="err">)(&lt;/span>&lt;span class="s2">&amp;#34;TEMP&amp;#34;&lt;/span>&lt;span class="err">),&lt;/span> &lt;span class="err">logFileName)&lt;/span> &lt;span class="err">+&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;\&amp;#34; /i \&amp;#34;&amp;#34;&lt;/span> &lt;span class="err">+&lt;/span> &lt;span class="err">wshShell.CurrentDirectory&lt;/span> &lt;span class="err">+&lt;/span> &lt;span class="s2">&amp;#34;\\&amp;#34;&lt;/span> &lt;span class="err">+&lt;/span> &lt;span class="err">msi&lt;/span> &lt;span class="err">+&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;\&amp;#34; AGENTSERVICEADDRESS=\&amp;#34;&amp;#34;&lt;/span> &lt;span class="err">+&lt;/span> &lt;span class="err">agentAddress&lt;/span> &lt;span class="err">+&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;\&amp;#34; AGENTID=\&amp;#34;&amp;#34;&lt;/span> &lt;span class="err">+&lt;/span> &lt;span class="err">typeLib.Guid.toString().substring(&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="err">,&lt;/span> &lt;span class="mi">38&lt;/span>&lt;span class="err">)&lt;/span> &lt;span class="err">+&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;\&amp;#34; DEPLOYMENTSERVERADDRESS=\&amp;#34;&amp;#34;&lt;/span> &lt;span class="err">+&lt;/span> &lt;span class="err">dsAddress&lt;/span> &lt;span class="err">+&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="s2">&amp;#34;\&amp;#34; RSAKEYPATH=\&amp;#34;&amp;#34;&lt;/span> &lt;span class="err">+&lt;/span> &lt;span class="err">wshShell.CurrentDirectory&lt;/span> &lt;span class="err">+&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="c1">//&amp;#34;\&amp;#34; PREDEFINEDAGENTTARGETS=\&amp;#34;Sims Fms Discover&amp;#34; +
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1">&lt;/span> &lt;span class="s2">&amp;#34;\&amp;#34;&amp;#34;&lt;/span>&lt;span class="err">,&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="err">,&lt;/span> &lt;span class="kc">true&lt;/span>&lt;span class="err">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="err">function&lt;/span> &lt;span class="err">is&lt;/span>&lt;span class="mi">64&lt;/span>&lt;span class="err">()&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">var&lt;/span> &lt;span class="err">shell&lt;/span> &lt;span class="err">=&lt;/span> &lt;span class="err">WScript.CreateObject(&lt;/span>&lt;span class="nt">&amp;#34;WScript.Shell&amp;#34;&lt;/span>&lt;span class="err">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="err">return&lt;/span> &lt;span class="err">(wshShell.Environment(&lt;/span>&lt;span class="s2">&amp;#34;SYSTEM&amp;#34;&lt;/span>&lt;span class="err">)(&lt;/span>&lt;span class="s2">&amp;#34;PROCESSOR_ARCHITECTURE&amp;#34;&lt;/span>&lt;span class="err">).indexOf(&lt;/span>&lt;span class="s2">&amp;#34;64&amp;#34;&lt;/span>&lt;span class="err">)&lt;/span> &lt;span class="err">+&lt;/span> &lt;span class="mi">1&lt;/span>&lt;span class="err">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Save the AgentInstaller.js file in your newly created SIMS folder. Your folder should then look something like this.&lt;/p>
&lt;p>&lt;img src="https://endpointmgt.com/p/deploysims/post/InstallSims/img/image-1.png"
width="258"
height="193"
srcset="https://endpointmgt.com/p/deploysims/post/InstallSims/img/image-1_hu_714b8f17d5165d8.png 480w, https://endpointmgt.com/p/deploysims/post/InstallSims/img/image-1_hu_7d36794359e03b2d.png 1024w"
loading="lazy"
alt="Install Files"
class="gallery-image"
data-flex-grow="133"
data-flex-basis="320px"
>&lt;/p>
&lt;h3 id="wrapping-time">Wrapping Time
&lt;/h3>&lt;p>I’ll assume you already know how to wrap packages via &lt;a class="link" href="https://go.microsoft.com/fwlink/?linkid=2065730" title="Microsoft Win32 Content Prep Tool"
target="_blank" rel="noopener"
>Microsoft Win32 Content Prep Tool&lt;/a>. Packing the content should look something like this…&lt;/p>
&lt;p>&lt;img src="https://endpointmgt.com/p/deploysims/post/InstallSims/img/image-2.png"
width="588"
height="116"
srcset="https://endpointmgt.com/p/deploysims/post/InstallSims/img/image-2_hu_16981aeaf4d9b128.png 480w, https://endpointmgt.com/p/deploysims/post/InstallSims/img/image-2_hu_db19ccb101e49673.png 1024w"
loading="lazy"
alt="Microsoft Win32 Content Prep Tool"
class="gallery-image"
data-flex-grow="506"
data-flex-basis="1216px"
>&lt;/p>
&lt;h3 id="upload-time">Upload Time
&lt;/h3>&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-text" data-lang="text">&lt;span class="line">&lt;span class="cl">Install Command: Solus3AgentInstaller.bat
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Uninstall Command: msiexec.exe /qn /x {PRODUCT-CODE} /lv* “%TEMP%\uninstall.log”
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Install behavior: System
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>It should look like this…&lt;/p>
&lt;p>&lt;img src="https://endpointmgt.com/p/deploysims/post/InstallSims/img/image-3.png"
width="774"
height="547"
srcset="https://endpointmgt.com/p/deploysims/post/InstallSims/img/image-3_hu_fb06c62835fc2f13.png 480w, https://endpointmgt.com/p/deploysims/post/InstallSims/img/image-3_hu_710ebfdafacb3a9f.png 1024w"
loading="lazy"
alt="Microsoft Intune Install Commands"
class="gallery-image"
data-flex-grow="141"
data-flex-basis="339px"
>&lt;/p>
&lt;p>For the detection, we’ll use a file installed as part of the installer&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre tabindex="0" class="chroma">&lt;code class="language-text" data-lang="text">&lt;span class="line">&lt;span class="cl">Rule Type: File
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Path: C:\Program Files\SOLUS3\AgentService
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">File or Folder: Infrastructure.dll
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Detection Method: File or folder exists
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Associated with a 32-bit app on 64-bit clients: No
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>It should look like this…&lt;/p>
&lt;p>&lt;img src="https://endpointmgt.com/p/deploysims/post/InstallSims/img/image-4.png"
width="557"
height="234"
srcset="https://endpointmgt.com/p/deploysims/post/InstallSims/img/image-4_hu_702b8cb870cf949e.png 480w, https://endpointmgt.com/p/deploysims/post/InstallSims/img/image-4_hu_81c8af9430ed1e0a.png 1024w"
loading="lazy"
alt="Microsoft Intune App Detection"
class="gallery-image"
data-flex-grow="238"
data-flex-basis="571px"
>&lt;/p>
&lt;h2 id="deployment-time">Deployment Time
&lt;/h2>&lt;p>Assign your newly created and updated app to users or devices as you desire.&lt;/p>
&lt;h3 id="success">Success?
&lt;/h3>&lt;p>You should now have the app installed.&lt;/p>
&lt;p>&lt;img src="https://endpointmgt.com/p/deploysims/post/InstallSims/img/image-5.png"
width="962"
height="540"
srcset="https://endpointmgt.com/p/deploysims/post/InstallSims/img/image-5_hu_f1053157cd39505b.png 480w, https://endpointmgt.com/p/deploysims/post/InstallSims/img/image-5_hu_fba00775511b1d98.png 1024w"
loading="lazy"
alt="Installation Success"
class="gallery-image"
data-flex-grow="178"
data-flex-basis="427px"
>&lt;/p>
&lt;h2 id="next-steps">Next Steps.
&lt;/h2>&lt;p>Now that you have the Agent installed. You’ll need to login to the Solus3 server and deploy the Sims package to the device from the deployment server.&lt;/p>
&lt;blockquote>
&lt;p>While this will deploy the Solus3 agent to devices, what this doesn’t take care of is ongoing updates. You’ll need to package any updates to the Solus3 agent. It’s beyond the scope of this article.&lt;/p>&lt;/blockquote>
&lt;p>For now and until the next post, I wish you well…&lt;/p></description></item></channel></rss>